<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>
      
        element组件库分析系列--Data类 |
          
            YzzTing
    </title>
    <!-- 主css -->
    <link rel="stylesheet" href="/sass/main.css">
      <!-- seo -->
      <meta name="description" content="element组件库分析系列–Data类由于组件中多多少少会用到Utils下一些工具类,所以打算先分析Utils中平常项目常见的工具类,先充data.js开始">
<meta name="keywords" content="javascript,Vue.js">
<meta property="og:type" content="article">
<meta property="og:title" content="element组件库分析系列--Data类">
<meta property="og:url" content="http://www.yzz1995.cn/2017/05/14/element组件库分析系列-Data类/index.html">
<meta property="og:site_name" content="YzzTing">
<meta property="og:description" content="element组件库分析系列–Data类由于组件中多多少少会用到Utils下一些工具类,所以打算先分析Utils中平常项目常见的工具类,先充data.js开始">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2017-08-22T07:02:58.147Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="element组件库分析系列--Data类">
<meta name="twitter:description" content="element组件库分析系列–Data类由于组件中多多少少会用到Utils下一些工具类,所以打算先分析Utils中平常项目常见的工具类,先充data.js开始">
        <!-- facicon -->
        
          <link rel="icon" href="http://7xp1k3.com1.z0.glb.clouddn.com/octocat-de-los-muertos.jpg">
          
            <!-- 统计 -->
            
              <script>
                var _hmt = _hmt || [];
                (function () {
                  var hm = document.createElement("script");
                  hm.src = "//hm.baidu.com/hm.js?c21994907883f37ffd80e13627dd4faa";
                  var s = document.getElementsByTagName("script")[0];
                  s.parentNode.insertBefore(hm, s);
                })();
              </script>
              
                
                    <script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
</head>
	<body>
		<div class="main">
			<div id="mobile-bar">
    <a class="menu-button"></a>
    <a class="logo" href="/">
        Yzz
    </a>
</div>
<header class="nav-header">
    <a href="/" class="logo-link">
        Yzz
    </a>
    
        
            <ul class="nav nav-list">
                <li class="nav-list-item">
                    <a href="/">
                        Home
                    </a>
                </li>
                
                    
                            
        
                        <li class="nav-list-item">
                            <a href="/about">
                                About
                            </a>
                        </li>
                        
                            
        
                        <li class="nav-list-item">
                            <a href="/tags">
                                Tags
                            </a>
                        </li>
                        
                            
        
                        <li class="nav-list-item">
                            <a href="/archives">
                                Archives
                            </a>
                        </li>
                        
                            
            </ul>
</header>
<div class="sidebar">
    
            
    <ul class="main-menu">
        <li class="main-menu-item"><a href="/">Home</a></li>
        
            
        
            
        <li class="main-menu-item"><a href="/about">About</a></li>
            
        
            
        <li class="main-menu-item"><a href="/tags">Tags</a></li>
            
        
            
        <li class="main-menu-item"><a href="/archives">Archives</a></li>
            
        
    </ul>
</div>

    <h1 class="blog-title">The
        Yzz Blog</h1>
			
<article class="article-main" itemscope itemprop="blogPost">
        <div class="articleCon">
            <header class="article-header">
                <h1 itemprop="name">
                    <a href="/2017/05/14/element组件库分析系列-Data类/" class="article-title">element组件库分析系列--Data类</a>
                </h1>
            </header>
            <div class="article-meta">
                <div class="article-dateTime">
    <a href="/2017/05/14/element组件库分析系列-Data类/" class="article-date">
        <time datetime="5月 14日 2017" itemprop="datePublished">
            5月 14日 2017
        </time>
    </a>
</div>

            </div>
            <div class="article-inner">
                <div class="article-entry" itemprop="articleBody">
                    <h2 id="element组件库分析系列–Data类"><a href="#element组件库分析系列–Data类" class="headerlink" title="element组件库分析系列–Data类"></a>element组件库分析系列–Data类</h2><p>由于组件中多多少少会用到Utils下一些工具类,所以打算先分析Utils中平常项目常见的工具类,先充data.js开始</p>
<a id="more"></a>
<h3 id="data-js"><a href="#data-js" class="headerlink" title="data.js"></a>data.js</h3><p>这个处理时间格式的js文件足足有344行,是我见过处理时间最详细的方式.我采用直接注释源码的方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//这里忽略了开源信息</span></div><div class="line"></div><div class="line"><span class="comment">// 总体用了常见的立即执行函数 IFFE()</span></div><div class="line"></div><div class="line"><span class="comment">/*eslint-disable*/</span></div><div class="line"><span class="comment">// 把 YYYY-MM-DD 改成了 yyyy-MM-dd</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">main</span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Parse or format dates</span></div><div class="line"><span class="comment">   * @class fecha</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  <span class="keyword">var</span> fecha = &#123;&#125;;</div><div class="line">  <span class="comment">// 匹配1-4个数字,1-4个M,yy或者yyyy,1-4个S,Do,ZZ,HH,hh,MM,ss,DD,mm,a和A,''里的内容,""里的内容... 真的复杂</span></div><div class="line">  <span class="keyword">var</span> token = <span class="regexp">/d&#123;1,4&#125;|M&#123;1,4&#125;|yy(?:yy)?|S&#123;1,3&#125;|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g</span>;</div><div class="line">  <span class="comment">// 匹配1-2位数字 相等于/d&#123;1,2&#125;???</span></div><div class="line">  <span class="keyword">var</span> twoDigits = <span class="regexp">/\d\d?/</span>;</div><div class="line">  <span class="comment">// 匹配3位数字</span></div><div class="line">  <span class="keyword">var</span> threeDigits = <span class="regexp">/\d&#123;3&#125;/</span>;</div><div class="line">  <span class="comment">// 匹配4位数字</span></div><div class="line">  <span class="keyword">var</span> fourDigits = <span class="regexp">/\d&#123;4&#125;/</span>;</div><div class="line">  <span class="comment">//这句没有看懂...</span></div><div class="line">  <span class="keyword">var</span> word = <span class="regexp">/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+)&#123;1,2&#125;/i</span>;</div><div class="line">  <span class="keyword">var</span> noop = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  &#125;;</div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * shorten是缩短的意思,我理解他是将需要运算的数值,缩短到一定的长度 ex:MonDay =&gt; Mon</span></div><div class="line"><span class="comment">   * @param &#123;*&#125; arr 需要缩短的数组</span></div><div class="line"><span class="comment">   * @param &#123;*&#125; sLen //需要缩短的长度</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">shorten</span>(<span class="params">arr, sLen</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> newArr = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</div><div class="line">      newArr.push(arr[i].substr(<span class="number">0</span>, sLen));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newArr;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * 转换英文日期对应的数字</span></div><div class="line"><span class="comment">   * @param &#123;*&#125; arrName 转换的数据 </span></div><div class="line"><span class="comment">   */</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">monthUpdate</span>(<span class="params">arrName</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">d, v, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> index = i18n[arrName].indexOf(v.charAt(<span class="number">0</span>).toUpperCase() + v.substr(<span class="number">1</span>).toLowerCase());<span class="comment">//数值的前两位,结合情况具体分析</span></div><div class="line">      <span class="keyword">if</span> (~index) &#123;</div><div class="line">        <span class="comment">//这里用了 ~按位非 操作符,感觉有点炫技..</span></div><div class="line">        d.month = index;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * 统一风格,将日期,月份,时间小于10的加上0的前缀.ex:1 =&gt; 01</span></div><div class="line"><span class="comment">   * @param &#123;*&#125; val 加0前缀的数值 </span></div><div class="line"><span class="comment">   * @param &#123;*&#125; len 数值长度</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">pad</span>(<span class="params">val, len</span>) </span>&#123;</div><div class="line">    val = <span class="built_in">String</span>(val);</div><div class="line">    len = len || <span class="number">2</span>;gaobaiqiqiu</div><div class="line">    <span class="keyword">while</span> (val.length &lt; len) &#123;</div><div class="line">      val = <span class="string">'0'</span> + val;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> val;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> dayNames = [<span class="string">'Sunday'</span>, <span class="string">'Monday'</span>, <span class="string">'Tuesday'</span>, <span class="string">'Wednesday'</span>, <span class="string">'Thursday'</span>, <span class="string">'Friday'</span>, <span class="string">'Saturday'</span>];</div><div class="line">  <span class="keyword">var</span> monthNames = [<span class="string">'January'</span>, <span class="string">'February'</span>, <span class="string">'March'</span>, <span class="string">'April'</span>, <span class="string">'May'</span>, <span class="string">'June'</span>, <span class="string">'July'</span>, <span class="string">'August'</span>, <span class="string">'September'</span>, <span class="string">'October'</span>, <span class="string">'November'</span>, <span class="string">'December'</span>];</div><div class="line">  <span class="keyword">var</span> monthNamesShort = shorten(monthNames, <span class="number">3</span>); <span class="comment">//取月份前三位</span></div><div class="line">  <span class="keyword">var</span> dayNamesShort = shorten(dayNames, <span class="number">3</span>); <span class="comment">//取日期前三位</span></div><div class="line">  fecha.i18n = &#123;</div><div class="line">    dayNamesShort: dayNamesShort,</div><div class="line">    dayNames: dayNames,</div><div class="line">    monthNamesShort: monthNamesShort,</div><div class="line">    monthNames: monthNames,</div><div class="line">    amPm: [<span class="string">'am'</span>, <span class="string">'pm'</span>],</div><div class="line">    DoFn: <span class="function"><span class="keyword">function</span> <span class="title">DoFn</span>(<span class="params">D</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> D + [<span class="string">'th'</span>, <span class="string">'st'</span>, <span class="string">'nd'</span>, <span class="string">'rd'</span>][D % <span class="number">10</span> &gt; <span class="number">3</span> ? <span class="number">0</span> : (D - D % <span class="number">10</span> !== <span class="number">10</span>) * D % <span class="number">10</span>]; <span class="comment">//给日期加后缀.ex: 1 =&gt; 1st %操作符优先级高于加减乘除</span></div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> formatFlags = &#123;</div><div class="line">    D: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getDay();<span class="comment">//返回星期里的某一天 0-6</span></div><div class="line">    &#125;,</div><div class="line">    DD: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getDay()); <span class="comment">//返回星期里的某一天 00-06</span></div><div class="line">    &#125;,</div><div class="line">    Do: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> i18n.DoFn(dateObj.getDate()); <span class="comment">//返回月份具体某一天 ex: 2nd</span></div><div class="line">    &#125;,</div><div class="line">    d: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getDate(); <span class="comment">//返回月份里第几天</span></div><div class="line">    &#125;,</div><div class="line">    dd: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getDate()); <span class="comment">//返回月份里第几天</span></div><div class="line">    &#125;,</div><div class="line">    ddd: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> i18n.dayNamesShort[dateObj.getDay()]; <span class="comment">//返回具体某一天对应的英文缩写 ex: 1 =&gt; Mon</span></div><div class="line">    &#125;,</div><div class="line">    dddd: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> i18n.dayNames[dateObj.getDay()]; <span class="comment">//返回具体某一天对应英文全称 ex: 1 =&gt; MonDay</span></div><div class="line">    &#125;,</div><div class="line">    M: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getMonth() + <span class="number">1</span>; <span class="comment">//返回具体月份</span></div><div class="line">    &#125;,</div><div class="line">    MM: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getMonth() + <span class="number">1</span>); <span class="comment">//返回具体月份 ex: 01</span></div><div class="line">    &#125;,</div><div class="line">    MMM: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> i18n.monthNamesShort[dateObj.getMonth()]; <span class="comment">//返回具体月份的英文缩写 1 =&gt; Jan</span></div><div class="line">    &#125;,</div><div class="line">    MMMM: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> i18n.monthNames[dateObj.getMonth()]; <span class="comment">//返回具体月份的英文全称 1 =&gt; January</span></div><div class="line">    &#125;,</div><div class="line">    yy: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">String</span>(dateObj.getFullYear()).substr(<span class="number">2</span>); <span class="comment">//将年份转为字符串,取后两位 2017 =&gt; 17</span></div><div class="line">    &#125;,</div><div class="line">    yyyy: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getFullYear(); <span class="comment">//取完整年份</span></div><div class="line">    &#125;,</div><div class="line">    h: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getHours() % <span class="number">12</span> || <span class="number">12</span>; <span class="comment">// 12小时制</span></div><div class="line">    &#125;,</div><div class="line">    hh: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getHours() % <span class="number">12</span> || <span class="number">12</span>); <span class="comment">// 12小时制 加0前缀</span></div><div class="line">    &#125;,</div><div class="line">    H: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getHours(); <span class="comment">//24小时制</span></div><div class="line">    &#125;,</div><div class="line">    HH: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getHours()); <span class="comment">//24小时制 加前缀</span></div><div class="line">    &#125;,</div><div class="line">    m: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getMinutes(); <span class="comment">// 分钟</span></div><div class="line">    &#125;,</div><div class="line">    mm: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getMinutes()); <span class="comment">//加0前缀分钟</span></div><div class="line">    &#125;,</div><div class="line">    s: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getSeconds(); <span class="comment">//秒</span></div><div class="line">    &#125;,</div><div class="line">    ss: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getSeconds()); <span class="comment">//加0前缀秒</span></div><div class="line">    &#125;,</div><div class="line">    S: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Math</span>.round(dateObj.getMilliseconds() / <span class="number">100</span>); <span class="comment">// 一位毫秒数</span></div><div class="line">    &#125;,</div><div class="line">    SS: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(<span class="built_in">Math</span>.round(dateObj.getMilliseconds() / <span class="number">10</span>), <span class="number">2</span>); <span class="comment">//两位毫秒数</span></div><div class="line">    &#125;,</div><div class="line">    SSS: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> pad(dateObj.getMilliseconds(), <span class="number">3</span>); <span class="comment">// 三位毫秒数</span></div><div class="line">    &#125;,</div><div class="line">    a: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getHours() &lt; <span class="number">12</span> ? i18n.amPm[<span class="number">0</span>] : i18n.amPm[<span class="number">1</span>]; <span class="comment">// 返回上下午</span></div><div class="line">    &#125;,</div><div class="line">    A: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> dateObj.getHours() &lt; <span class="number">12</span> ? i18n.amPm[<span class="number">0</span>].toUpperCase() : i18n.amPm[<span class="number">1</span>].toUpperCase(); <span class="comment">// 返回上下午 大小写</span></div><div class="line">    &#125;,</div><div class="line">    ZZ: <span class="function"><span class="keyword">function</span>(<span class="params">dateObj</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> o = dateObj.getTimezoneOffset();</div><div class="line">      <span class="keyword">return</span> (o &gt; <span class="number">0</span> ? <span class="string">'-'</span> : <span class="string">'+'</span>) + pad(<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.abs(o) / <span class="number">60</span>) * <span class="number">100</span> + <span class="built_in">Math</span>.abs(o) % <span class="number">60</span>, <span class="number">4</span>); <span class="comment">//时区偏移</span></div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">//匹配不同的解析</span></div><div class="line">  <span class="keyword">var</span> parseFlags = &#123;</div><div class="line">    d: [twoDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.day = v;</div><div class="line">    &#125;],</div><div class="line">    M: [twoDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.month = v - <span class="number">1</span>;</div><div class="line">    &#125;],</div><div class="line">    yy: [twoDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> da = <span class="keyword">new</span> <span class="built_in">Date</span>(), cent = +(<span class="string">''</span> + da.getFullYear()).substr(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">      d.year = <span class="string">''</span> + (v &gt; <span class="number">68</span> ? cent - <span class="number">1</span> : cent) + v;</div><div class="line">    &#125;],</div><div class="line">    h: [twoDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.hour = v;</div><div class="line">    &#125;],</div><div class="line">    m: [twoDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.minute = v;</div><div class="line">    &#125;],</div><div class="line">    s: [twoDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.second = v;</div><div class="line">    &#125;],</div><div class="line">    yyyy: [fourDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.year = v;</div><div class="line">    &#125;],</div><div class="line">    S: [<span class="regexp">/\d/</span>, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.millisecond = v * <span class="number">100</span>;</div><div class="line">    &#125;],</div><div class="line">    SS: [<span class="regexp">/\d&#123;2&#125;/</span>, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.millisecond = v * <span class="number">10</span>;</div><div class="line">    &#125;],</div><div class="line">    SSS: [threeDigits, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      d.millisecond = v;</div><div class="line">    &#125;],</div><div class="line">    D: [twoDigits, noop],</div><div class="line">    ddd: [word, noop],</div><div class="line">    MMM: [word, monthUpdate(<span class="string">'monthNamesShort'</span>)],</div><div class="line">    MMMM: [word, monthUpdate(<span class="string">'monthNames'</span>)],</div><div class="line">    a: [word, <span class="function"><span class="keyword">function</span> (<span class="params">d, v, i18n</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> val = v.toLowerCase();</div><div class="line">      <span class="keyword">if</span> (val === i18n.amPm[<span class="number">0</span>]) &#123;</div><div class="line">        d.isPm = <span class="literal">false</span>;</div><div class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val === i18n.amPm[<span class="number">1</span>]) &#123;</div><div class="line">        d.isPm = <span class="literal">true</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;],</div><div class="line">    ZZ: [<span class="regexp">/[\+\-]\d\d:?\d\d/</span>, <span class="function"><span class="keyword">function</span> (<span class="params">d, v</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> parts = (v + <span class="string">''</span>).match(<span class="regexp">/([\+\-]|\d\d)/gi</span>), minutes;</div><div class="line"></div><div class="line">      <span class="keyword">if</span> (parts) &#123;</div><div class="line">        minutes = +(parts[<span class="number">1</span>] * <span class="number">60</span>) + <span class="built_in">parseInt</span>(parts[<span class="number">2</span>], <span class="number">10</span>);</div><div class="line">        d.timezoneOffset = parts[<span class="number">0</span>] === <span class="string">'+'</span> ? minutes : -minutes;</div><div class="line">      &#125;</div><div class="line">    &#125;]</div><div class="line">  &#125;;</div><div class="line">  parseFlags.DD = parseFlags.D;</div><div class="line">  parseFlags.dddd = parseFlags.ddd;</div><div class="line">  parseFlags.Do = parseFlags.dd = parseFlags.d;</div><div class="line">  parseFlags.mm = parseFlags.m;</div><div class="line">  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;</div><div class="line">  parseFlags.MM = parseFlags.M;</div><div class="line">  parseFlags.ss = parseFlags.s;</div><div class="line">  parseFlags.A = parseFlags.a;</div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">// Some common format strings</span></div><div class="line">  <span class="comment">// 通用的格式</span></div><div class="line">  fecha.masks = &#123;</div><div class="line">    <span class="string">'default'</span>: <span class="string">'ddd MMM dd yyyy HH:mm:ss'</span>,</div><div class="line">    shortDate: <span class="string">'M/D/yy'</span>,</div><div class="line">    mediumDate: <span class="string">'MMM d, yyyy'</span>,</div><div class="line">    longDate: <span class="string">'MMMM d, yyyy'</span>,</div><div class="line">    fullDate: <span class="string">'dddd, MMMM d, yyyy'</span>,</div><div class="line">    shortTime: <span class="string">'HH:mm'</span>,</div><div class="line">    mediumTime: <span class="string">'HH:mm:ss'</span>,</div><div class="line">    longTime: <span class="string">'HH:mm:ss.SSS'</span></div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="comment">/***</span></div><div class="line"><span class="comment">   * Format a date</span></div><div class="line"><span class="comment">   * @method format</span></div><div class="line"><span class="comment">   * @param &#123;Date|number&#125; dateObj</span></div><div class="line"><span class="comment">   * @param &#123;string&#125; mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  fecha.format = <span class="function"><span class="keyword">function</span> (<span class="params">dateObj, mask, i18nSettings</span>) </span>&#123;</div><div class="line">    <span class="comment">// 设置数据格式</span></div><div class="line">    <span class="keyword">var</span> i18n = i18nSettings || fecha.i18n;</div><div class="line"></div><div class="line">    <span class="comment">// 实例化Date类</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> dateObj === <span class="string">'number'</span>) &#123;</div><div class="line">      dateObj = <span class="keyword">new</span> <span class="built_in">Date</span>(dateObj);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 检测类型 Object.prototype.toString.call() 这个检测类型的方法很好用</span></div><div class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(dateObj) !== <span class="string">'[object Date]'</span> || <span class="built_in">isNaN</span>(dateObj.getTime())) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Invalid Date in fecha.format'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 设置通用格式???</span></div><div class="line">    mask = fecha.masks[mask] || mask || fecha.masks[<span class="string">'default'</span>];</div><div class="line"></div><div class="line">    <span class="comment">// 使用对应的格式化方法???</span></div><div class="line">    <span class="keyword">return</span> mask.replace(token, <span class="function"><span class="keyword">function</span> (<span class="params">$<span class="number">0</span></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> $<span class="number">0</span> <span class="keyword">in</span> formatFlags ? formatFlags[$<span class="number">0</span>](dateObj, i18n) : $<span class="number">0.</span>slice(<span class="number">1</span>, $<span class="number">0.</span>length - <span class="number">1</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Parse a date string into an object, changes - into /</span></div><div class="line"><span class="comment">   * @method parse</span></div><div class="line"><span class="comment">   * @param &#123;string&#125; dateStr Date string</span></div><div class="line"><span class="comment">   * @param &#123;string&#125; format Date parse format</span></div><div class="line"><span class="comment">   * @returns &#123;Date|boolean&#125;</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  fecha.parse = <span class="function"><span class="keyword">function</span> (<span class="params">dateStr, format, i18nSettings</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> i18n = i18nSettings || fecha.i18n;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> format !== <span class="string">'string'</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Invalid format in fecha.parse'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    format = fecha.masks[format] || format;</div><div class="line"></div><div class="line">    <span class="comment">// Avoid regular expression denial of service, fail early for really long strings</span></div><div class="line">    <span class="comment">// https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS</span></div><div class="line">    <span class="keyword">if</span> (dateStr.length &gt; <span class="number">1000</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> isValid = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">var</span> dateInfo = &#123;&#125;;</div><div class="line">    format.replace(token, <span class="function"><span class="keyword">function</span> (<span class="params">$<span class="number">0</span></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (parseFlags[$<span class="number">0</span>]) &#123;</div><div class="line">        <span class="keyword">var</span> info = parseFlags[$<span class="number">0</span>]; <span class="comment">//对应解析方法</span></div><div class="line">        <span class="keyword">var</span> index = dateStr.search(info[<span class="number">0</span>]); <span class="comment">//查找对应匹配</span></div><div class="line">        <span class="keyword">if</span> (!~index) &#123;</div><div class="line">          isValid = <span class="literal">false</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          dateStr.replace(info[<span class="number">0</span>], <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">            info[<span class="number">1</span>](dateInfo, result, i18n); <span class="comment">//对应函数处理</span></div><div class="line">            dateStr = dateStr.substr(index + result.length); <span class="comment">//截取长度</span></div><div class="line">            <span class="keyword">return</span> result;</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="keyword">return</span> parseFlags[$<span class="number">0</span>] ? <span class="string">''</span> : $<span class="number">0.</span>slice(<span class="number">1</span>, $<span class="number">0.</span>length - <span class="number">1</span>);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!isValid) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//处理12小时制</span></div><div class="line">    <span class="keyword">var</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">if</span> (dateInfo.isPm === <span class="literal">true</span> &amp;&amp; dateInfo.hour != <span class="literal">null</span> &amp;&amp; +dateInfo.hour !== <span class="number">12</span>) &#123;</div><div class="line">      dateInfo.hour = +dateInfo.hour + <span class="number">12</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dateInfo.isPm === <span class="literal">false</span> &amp;&amp; +dateInfo.hour === <span class="number">12</span>) &#123;</div><div class="line">      dateInfo.hour = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//时区偏移</span></div><div class="line">    <span class="keyword">var</span> date;</div><div class="line">    <span class="keyword">if</span> (dateInfo.timezoneOffset != <span class="literal">null</span>) &#123;</div><div class="line">      dateInfo.minute = +(dateInfo.minute || <span class="number">0</span>) - +dateInfo.timezoneOffset;</div><div class="line">      date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || <span class="number">0</span>, dateInfo.day || <span class="number">1</span>,</div><div class="line">        dateInfo.hour || <span class="number">0</span>, dateInfo.minute || <span class="number">0</span>, dateInfo.second || <span class="number">0</span>, dateInfo.millisecond || <span class="number">0</span>));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      date = <span class="keyword">new</span> <span class="built_in">Date</span>(dateInfo.year || today.getFullYear(), dateInfo.month || <span class="number">0</span>, dateInfo.day || <span class="number">1</span>,</div><div class="line">        dateInfo.hour || <span class="number">0</span>, dateInfo.minute || <span class="number">0</span>, dateInfo.second || <span class="number">0</span>, dateInfo.millisecond || <span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> date;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="comment">/* istanbul ignore next */</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">module</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">module</span>.exports) &#123;</div><div class="line">    <span class="built_in">module</span>.exports = fecha;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd) &#123;</div><div class="line">    define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> fecha;</div><div class="line">    &#125;);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    main.fecha = fecha;</div><div class="line">  &#125;</div><div class="line">&#125;)(<span class="keyword">this</span>);</div></pre></td></tr></table></figure>
<h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><p>下次尝试分析第一个组件Alert</p>

                </div>
                
<nav id="article-nav">
  
    <a href="/2017/05/17/element组件库分析系列-Alert组件/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title">
        
          element组件库分析系列--Alert组件 >
        
      </div>
    </a>
  
  
    <a href="/2017/05/12/element组件库分析系列－－项目总览/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"> < element组件库分析系列--项目总览</div>
    </a>
  
</nav>


            </div>
        </div>
        
            <div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//yzzting.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//yzzting.disqus.com/count.js" async></script>

        
        
</article>



		</div>
		<div id="heart"></div>

    <footer class="blog-footer" id="blog-footer">
        <div id="footer-info" class="inner">
            Made with ♥ by <a href="https://github.com/yzzting/hexo-theme-MyFairLady" target="_blank">MyFairLady</a>
        </div>
    </footer>
    <script src="/js/sidebar.js"></script>
    <script src="/js/toTop.js"></script>
    <script src="/js/bookmark.js"></script>
	</body>
	</html>
